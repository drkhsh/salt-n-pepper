template-pentest_update:
  pkg.uptodate:
    - refresh: True

template-pentest_install-qubes:
  pkg.installed:
    - pkgs:
      - qubes-core-agent-networking
      - qubes-core-agent-thunar
      - qubes-app-shutdown-idle
      - qubes-gpg-split
      - qubes-usb-proxy
      # quick hacking in appvms
      - qubes-core-agent-passwordless-root
    - skip_suggestions: True
    - install_recommends: False

# https://github.com/fabaff/security-lab/blob/master/ansible-playbooks/fsl-packages.yml
# includes majority of necessary tools ready in one group
'dnf group install --skip-broken -y "Security Lab"':
  cmd.run

template-pentest_install:
  pkg.installed:
    - pkgs:
      # general tools
      - tree
      - tig
      - tmux
      - bc
      # dotfiles
      - stow
      # copy-paste from cli
      - xclip
      # usb disks etc.
      - dosfstools
      - ntfs-3g
      - exfatprogs
      - lvm2
      - parted
      - gparted
      # build tools
      - llvm
      - clang
      - clang-tools-extra
      # python
      - python3
      - python3-pip
      # information gathering
      - finger
      - openldap-clients
      - checksec
      # networks
      - arpwatch
      - nmap-ncat
      - nfs-utils
      - samba
      - curl
      # vpn
      - openvpn
      - wireguard-tools
      - openconnect
      - vpnc
      # tor
      - tor
      - torsocks
      - torbrowser-launcher
      # hashes, passwords
      - hashid
      - hashcat
      # remote access
      - netcat
      - tigervnc
      - rdesktop
      - mosh
      - httptunnel
      - iodine
      # reverse engineering
      - ltrace
      - strace
      - radare2
      # steganography
      - steghide
      # file encryption
      - cryptsetup
      # static analyzers
      - bandit
      - cppcheck
      - ShellCheck
      # antivirus
      - clamav
      # spi programming
      - flashrom
      # i2c
      - i2c-tools
      # serial
      - minicom
      # sdr
      - gnuradio
      # vms
      - qemu
      - qemu-img
      # vcs
      - git
      - mercurial
      - subversion
      # bootloaders
      - uboot-tools
      - vboot-utils

template-pentest_mimeapps:
  file.managed:
    - name: /usr/share/applications/mimeapps.list
    - source: salt://template-pentest/mimeapps.list
    - user: root
    - group: root

